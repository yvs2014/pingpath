
name: pingpath
base: core24
version: 0.3
adopt-info: pingpath
icon: assets/icons/pingpath.svg
summary: ping wrapper for network diagnostic
description: |
  Network diagnostic tool based on parsing iputils 'ping' output with functionality of 'traceroute'.
  Inspired by ncurses look of 'mtr' and written in 'GTK4'.

platforms:
  amd64:
  arm64:
  armhf:
grade: stable
confinement: strict

apps:
  pingpath:  # with 3D plots and 2D graphs
    extensions: [gnome]
    command: usr/bin/pingpath
    desktop: usr/share/applications/net.tools.pingpath.desktop
    plugs:
      - network
      - network-observe # for system 'ping' tool
      - network-status  # for whois requests
  pingpath2: # with 2D graphs
    extensions: [gnome]
    command: usr/bin/pingpath2
    desktop: usr/share/applications/net.tools.pingpath2.desktop
    plugs:
      - network
      - network-observe # for system 'ping' tool
      - network-status  # for whois requests

parts:
  pingpath:
    plugin: cmake
    cmake-parameters:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCMAKE_INSTALL_PREFIX=/usr
#    source: .
    source: https://github.com/yvs2014/pingpath.git
    override-pull: |
      craftctl default
      craftctl set version="$(craftctl get version).$(git rev-list --count d3da356..HEAD)"
      _ICODIR="/usr/share/icons/hicolor/scalable/apps"
      _SEDEXP="s|Icon=pingpath|Icon=$_ICODIR/pingpath.svg|"
      sed -i "$_SEDEXP" assets/pingpath.desktop
      sed -i "$_SEDEXP" assets/pingpath2.desktop
    build-packages:
      - git
      - build-essential
      - pkgconf
      - libgl-dev
      - libepoxy-dev
      - libcglm-dev
    prime:
      - usr/bin/pingpath
      - usr/bin/pingpath2
      - usr/share/man/man1/pingpath.1.gz
      - usr/share/doc/pingpath/examples/pingpath.conf
      - usr/share/applications/net.tools.pingpath.desktop
      - usr/share/applications/net.tools.pingpath2.desktop
      - usr/share/icons/hicolor/scalable/apps/pingpath.svg

